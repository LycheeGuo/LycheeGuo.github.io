{{ $item := .item }}
{{ $link := $item.RelPermalink }}
{{ $target := "" }}
{{ if $item.Params.external_link }}
  {{ $link = $item.Params.external_link }}
  {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
{{ end }}

{{/* 获取图片逻辑 */}}
{{ $resource := ($item.Resources.ByType "image").GetMatch "*featured*" }}
{{ $image := "" }}
{{ if $resource }}
  {{ $image = $resource.Fill "350x230 Center" }} {{ else if $item.Params.image.filename }}
  {{ $imageResource := resources.Get (printf "media/%s" $item.Params.image.filename) }}
  {{ if $imageResource }}
     {{ $image = $imageResource.Fill "350x230 Center" }}
  {{ end }}
{{ end }}

<div class="group flex flex-col md:flex-row gap-6 items-start">
  
  <div class="flex-1 min-w-0"> <h3 class="text-xl font-bold mb-2 leading-tight">
      <a href="{{ $link }}" {{ $target | safeHTMLAttr }} class="text-gray-900 dark:text-gray-100 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">
        {{ $item.Title }}
      </a>
    </h3>

    <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-gray-500 dark:text-gray-400 mb-3 font-medium">
      {{ if not (eq $item.Params.show_date false) }}
      <span class="flex items-center">
        {{ $item.Date | time.Format "Jan 2, 2006" }}
      </span>
      {{ end }}
      
      {{ if $item.Params.publication }}
      <span class="text-indigo-500 dark:text-indigo-300 uppercase tracking-wide">
        {{ $item.Params.publication | markdownify }}
      </span>
      {{ end }}
    </div>

    <div class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed line-clamp-3">
      {{ if $item.Params.summary }}
        {{ $item.Params.summary | markdownify | emojify }}
      {{ else }}
        {{ $item.Summary | markdownify | emojify }}
      {{ end }}
    </div>
    
    <div class="mt-3">
      <a href="{{ $link }}" class="text-indigo-600 dark:text-indigo-400 text-sm font-semibold hover:underline">
        Read more →
      </a>
    </div>
  </div>

  {{ if $image }}
  <div class="w-full md:w-[35%] flex-shrink-0 mt-4 md:mt-0">
    <a href="{{ $link }}" {{ $target | safeHTMLAttr }} class="block overflow-hidden rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
      <img src="{{ $image.RelPermalink }}" 
           width="{{ $image.Width }}" 
           height="{{ $image.Height }}"
           alt="{{ $item.Title }}" 
           loading="lazy"
           class="w-full h-auto object-cover transform group-hover:scale-105 transition-transform duration-500 ease-out">
    </a>
  </div>
  {{ end }}
</div>

<hr class="border-gray-100 dark:border-gray-800 my-8 last:hidden" />
